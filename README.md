freerip allows you to quickly rip your own DVDs and CDs for personal use.  Simply, insert a disc into the drive and it will be ejected once complete.

This fork uses blkid within the jail to identify and handle multiple disk drives.

Tested on ```FreeNAS-11.3-U1```

---
**Hey! This readme could use your help.** If you're good with FreeBSD jails - which I am not - then you might be able to provide a proper config which allows mounting ```/dev/cd*``` within the jail. My jail setup is based on what ended up working for me, so it's neither best practice nor particularily _good_.

---

# Usage
   1. Insert a CD or DVD into the drive
   2. Wait
   3. The CD/DVD will be ejected once all the content has been copied.

# Building freerip.sh
To make development easier the freerip.sh script is generated by combining files in the src/ directory.  To build your own copy of freerip.sh for installation run ```make``` to create a directory (dist/) with files needed for installation.
    

# Installation

   1. Run ```make``` to gather all files needed for installation into dist/
   2. Install devd config and launcher on host, not in the jail

    sudo cp freerip.conf /etc/devd/
    sudo cp freerip-launcher /usr/local/bin/
   
   3. For me, /etc/devd/ was reset when rebooting FreeNAS, therefore I also copied freerip.conf to /conf/base/etc/
    
    sudo cp freerip.conf /conf/base/etc/devd/

   4. Restart devd to pickup new config

    sudo /etc/rc.d/devd restart

   5. Create a new jail called ```freerip```

   6. Configure storage to be mounted at ```/mnt/freerip```.  All rips will be saved here.

   7. Copy ```freerip.sh``` into the jail

    sudo cp freerip.sh /mnt/jails/freerip/usr/local/bin/

   8. Install ```HandbrakeCLI``` into the jail as per Ryan Baumann's excellent [guide](https://ryanfb.github.io/etc/2016/04/21/installing_handbrake_on_freenas.html)
 
 Short version:
 
    pkg upgrade
    pkg install handbrake libass ffmpeg x265 libaacs libbdplus
    
    portsnap fetch extract
    cd /usr/ports/audio/lame && make install clean
    cd /usr/ports/multimedia/libdvdcss && make install clean

 
   9. Install e2fsprogs into the jail to get blkid
   
    pkg install e2fsprogs
    
   10. As of FreeNAS-11.3-U1 I had to install bash, too, as jails only came with csh (and I'm too lazy to fix the script to run with csh, sorry. Contributions are welcome.)
   
    pkg install bash

# Jail setup so the DVD drives are actually accessible
   **Please note:** _This is the setup which ended up working for me. I'm not a FreeBSD guru - in fact, I'm pretty horrible with Unix-derived systems. I neither guarantee this setup is correct, nor that it will work for you. Use at your own risk and be aware that mounting everything, as I do here, can potentially be dangerous when messing around inside a jail._
 
 
Change the following properties:
- Set ```devfs_ruleset``` to 3
   - You should _actually_ set up a new ruleset which allows mounting ```/dev/cd*```, but this works quick and dirty.
- Tick ```mount_devfs```, ```allow_mount```, and ```allow_mount_devfs```
- Set ```enforce_statfs``` to 0

# Debugging

On the host system:
   1. Stop devd

    sudo /etc/rc.d/devd stop

   2. Run devd in debug mode

    sudo devd -d

   3. Insert a new CD or DVD
